# Brief overview of the equations

The governing equations and the discretization is briefly introduced on this page. For more details we
refer to the following two references [1,2].

## Governing equations

Unlike classical continuum mechanics, where the internal force is written in terms of the stress, in PD, the internal force at a given material point is due to the sum of the pairwise forces of the neighboring points. i.e. the force in PD is expressed as the integral of the pairwise force density between the given point and another point in the neighborhood. Neighborhood of point <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;x" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;x" title="x" /></a> is typically taken as the ball of radius <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\delta" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\delta" title="\delta" /></a>, centered at <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;x" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;x" title="x" /></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\delta" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\delta" title="\delta" /></a> is the nonlocal length scale and is referred to as horizon. PD is often divided in two classes: bond-based and state-based models. In bond-based models, the two material points interact via a pairwise force law and the forces between the material points do not depend on the deformation state of surrounding points. In contrast, in the state-based models the volumetric deformation in the neighborhood of two points plays a role in the pariwise force. The governing equation of motion for the bond-based PD [3] reads as

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\varrho(\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X})&space;=&space;\int\limits_{B_\delta(\mathbf{X})}\mathbf{f}(\mathbf{u}(t,\mathbf{X}')-\mathbf{u}(t,\mathbf{X}),\mathbf{X}'-\mathbf{X})&space;d\mathbf{X}'&space;&plus;&space;\mathbf{b}(t,\mathbf{X})&space;\text{&space;in&space;}&space;D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\varrho(\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X})&space;=&space;\int\limits_{B_\delta(\mathbf{X})}\mathbf{f}(\mathbf{u}(t,\mathbf{X}')-\mathbf{u}(t,\mathbf{X}),\mathbf{X}'-\mathbf{X})&space;d\mathbf{X}'&space;&plus;&space;\mathbf{b}(t,\mathbf{X})&space;\text{&space;in&space;}&space;D" title="\varrho(\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X}) = \int\limits_{B_\delta(\mathbf{X})}\mathbf{f}(\mathbf{u}(t,\mathbf{X}')-\mathbf{u}(t,\mathbf{X}),\mathbf{X}'-\mathbf{X}) d\mathbf{X}' + \mathbf{b}(t,\mathbf{X}) \text{ in } D" /></a>

and the governing equation for the state-based PD [4] reads as 

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\varrho&space;(\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X})&space;=&space;\int\limits_{B_\delta(\mathbf{X})}&space;(T[\mathbf{X},t]\langle&space;\mathbf{X}'&space;-&space;\mathbf{X}&space;\rangle&space;-&space;T[\mathbf{X}',t]\langle&space;\mathbf{X}&space;-&space;\mathbf{X}'&space;\rangle)&space;d\mathbf{X}'&space;&plus;&space;\mathbf{b}(t,\mathbf{X})&space;\text{&space;in&space;}&space;D&space;\text{.}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\varrho&space;(\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X})&space;=&space;\int\limits_{B_\delta(\mathbf{X})}&space;(T[\mathbf{X},t]\langle&space;\mathbf{X}'&space;-&space;\mathbf{X}&space;\rangle&space;-&space;T[\mathbf{X}',t]\langle&space;\mathbf{X}&space;-&space;\mathbf{X}'&space;\rangle)&space;d\mathbf{X}'&space;&plus;&space;\mathbf{b}(t,\mathbf{X})&space;\text{&space;in&space;}&space;D&space;\text{.}" title="\varrho (\mathbf{X})\ddot{\mathbf{u}}(t,\mathbf{X}) = \int\limits_{B_\delta(\mathbf{X})} (T[\mathbf{X},t]\langle \mathbf{X}' - \mathbf{X} \rangle - T[\mathbf{X}',t]\langle \mathbf{X} - \mathbf{X}' \rangle) d\mathbf{X}' + \mathbf{b}(t,\mathbf{X}) \text{ in } D \text{.}" /></a>

Here <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\varrho" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\varrho" title="\varrho" /></a> denotes density of the material, <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\mathbf{u}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\mathbf{u}" title="\mathbf{u}" /></a> displacement field in the material, <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\ddot{\mathbf{u}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\ddot{\mathbf{u}}" title="\ddot{\mathbf{u}}" /></a> acceleration, and <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\mathbf{b}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\mathbf{b}" title="\mathbf{b}" /></a> external force density. The constitutive law, relating bond strain with bond force, is prescribed using either the pairwise force function <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\mathbf{f}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\mathbf{f}" title="\mathbf{f}" /></a> or the PD state <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;T" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;T" title="T" /></a> [4].


## Discretization 

Currently, the library supports finite difference (or more generally meshfree) discretization. Using the triangulation of arbitrary domain, the library can create a meshfree discretization. The library is equipped with necessary modules, such as FE elements and quadrature integration rules, for finite element discretization of PD. Next, we briefly discuss the finite difference/meshfree discretization of PD. Figure 1 shows the domain <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;D" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;D" title="D" /></a> discretized with the nodes <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;X&space;=&space;\{&space;X_i&space;\in&space;\mathbb{R}^3&space;\vert&space;i=1,\ldots,n\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;X&space;=&space;\{&space;X_i&space;\in&space;\mathbb{R}^3&space;\vert&space;i=1,\ldots,n\}" title="X = \{ X_i \in \mathbb{R}^3 \vert i=1,\ldots,n\}" /></a>. Each node <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;X_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;X_i" title="X_i" /></a> represents a small area/volume denoted by <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;V_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;V_i" title="V_i" /></a>. In PD, as previously mentioned, each point <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;X_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;X_i" title="X_i" /></a> interacts with neighboring points in ball (discrete) <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;B_\delta(X_i)&space;=&space;\{X_j:&space;\vert&space;X_i&space;-&space;X_j|&space;<&space;\delta&space;\}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;B_\delta(X_i)&space;=&space;\{X_j:&space;\vert&space;X_i&space;-&space;X_j|&space;<&space;\delta&space;\}" title="B_\delta(X_i) = \{X_j: \vert X_i - X_j| < \delta \}" /></a>. 


The discrete equation of motion is written as, for the bond-based PD,

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\varrho(X_i)\ddot{\mathbf{u}}(t,X_i)&space;=&space;\sum\limits_{j&space;\in&space;B_\delta(X_i)}\mathbf{f}(\mathbf{u}(t,X_j)-\mathbf{u}(t,X_i),X_j-X_i)&space;V_j&space;&plus;&space;\mathbf{b}(t,X_i)&space;\text{&space;in&space;}&space;D," target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;\varrho(X_i)\ddot{\mathbf{u}}(t,X_i)&space;=&space;\sum\limits_{j&space;\in&space;B_\delta(X_i)}\mathbf{f}(\mathbf{u}(t,X_j)-\mathbf{u}(t,X_i),X_j-X_i)&space;V_j&space;&plus;&space;\mathbf{b}(t,X_i)&space;\text{&space;in&space;}&space;D," title="\varrho(X_i)\ddot{\mathbf{u}}(t,X_i) = \sum\limits_{j \in B_\delta(X_i)}\mathbf{f}(\mathbf{u}(t,X_j)-\mathbf{u}(t,X_i),X_j-X_i) V_j + \mathbf{b}(t,X_i) \text{ in } D," /></a>

and, the state-based PD,

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\varrho&space;(X_i)\ddot{\mathbf{u}}(t,X_i)&space;=&space;\sum\limits_{j&space;\in&space;B_\delta(X_i)}&space;(T[X_i,t]\langle&space;X_j&space;-&space;X_i&space;\rangle&space;-&space;T[X_j,t]\langle&space;X_i&space;-&space;X_j&space;\rangle)&space;V_j&space;&plus;&space;\mathbf{b}(t,X_i)&space;\text{&space;in&space;}&space;D&space;\text{.}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\varrho&space;(X_i)\ddot{\mathbf{u}}(t,X_i)&space;=&space;\sum\limits_{j&space;\in&space;B_\delta(X_i)}&space;(T[X_i,t]\langle&space;X_j&space;-&space;X_i&space;\rangle&space;-&space;T[X_j,t]\langle&space;X_i&space;-&space;X_j&space;\rangle)&space;V_j&space;&plus;&space;\mathbf{b}(t,X_i)&space;\text{&space;in&space;}&space;D&space;\text{.}" title="\varrho (X_i)\ddot{\mathbf{u}}(t,X_i) = \sum\limits_{j \in B_\delta(X_i)} (T[X_i,t]\langle X_j - X_i \rangle - T[X_j,t]\langle X_i - X_j \rangle) V_j + \mathbf{b}(t,X_i) \text{ in } D \text{.}" /></a>

Here <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\mathbf{u}(t,X_i)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;\mathbf{u}(t,X_i)" title="\mathbf{u}(t,X_i)" /></a> denotes the displacement of node <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;X_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;X_i" title="X_i" /></a> at time <a href="https://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;0&space;\leq&space;t\leq&space;T" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dpi{120}&space;0&space;\leq&space;t\leq&space;T" title="0 \leq t\leq T" /></a>. For the time discretization, we can consider: *1)* implicit time integration and *2)* explicit time integration using either central difference or velocity verlet scheme.


## References

1. P. Diehl, P. K. Jha, H. Kaiser, R. Lipton, and M. Lévesque. An asynchronous and task-based implementation of peridynamics utilizing hpx—the C++ standard library for parallelism and concurrency. SN Applied Sciences, 2(12):2144, 2020, [10.1007/s42452-020-03784-x]({https://doi.org/10.1007/s42452-020-03784-x), [Preprint](https://arxiv.org/abs/1806.06917). 
2. Jha, PK, Lipton R. "Numerical convergence of finite difference approximations for state based peridynamic fracture models."  Computer Methods in Applied Mechanics and Engineering, 1 July 2019, 351(1), 184 - 225. [Link](https://doi.org/10.1016/j.cma.2019.03.024)
3. Silling, S. A., & Askari, E. (2005). A meshfree method based on the peridynamic model of164solid mechanics.Computers & Structures,83(17-18), 1526–1535. [https://doi.org/10.1651016/j.compstruc.2004.11.026](https://doi.org/10.1651016/j.compstruc.2004.11.026)
4. Silling, S. A., Epton, M., Weckner, O., Xu, J., & Askari. (2007). Peridynamic states and167constitutive modeling.Journal of Elasticity,88(2), 151–184.[https://doi.org/10.1007/168s10659-007-9125-1](https://doi.org/10.1007/168s10659-007-9125-1)